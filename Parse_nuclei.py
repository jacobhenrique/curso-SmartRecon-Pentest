import sys
import string
import requests
import json

dic_nuclei = {}

def parse():
    with open('/home/henrique/smart-recon/nuclei.json') as jsonfile:
        for linejson in jsonfile:
            jsonline = linejson.rstrip('\n')
            jsondata = json.loads(jsonline)
            for i in jsondata:
                dic_nuclei['template'] = (jsondata['templateID'])
                for i in jsondata['info']:
                    dic_nuclei['name'] = jsondata['info']['name']
                    dic_nuclei['severity'] = jsondata['info']['severity']
                    dic_nuclei['tags'] = jsondata['info']['tags']
                    dic_nuclei['host'] = jsondata['host']
                    dic_nuclei['type'] = jsondata['type']
                    dic_nuclei['matched'] = jsondata['matched']
                    dic_nuclei['extracted_results'] = jsondata['extracted_results']
                    dic_nuclei['ip'] = jsondata['ip']
            print(dic_nuclei)

            
def main():
    parse()

if __name__=='__main__':
    main()
