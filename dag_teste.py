# Importando as bibliotecas que vamos usar nesse exemplo
from airflow import DAG
from datetime import datetime, timedelta
from airflow.decorators import task
from airflow.operators.python import ExternalPythonOperator, PythonVirtualenvOperator
from airflow.operators.bash import BashOperator
from airflow.operators.empty import EmptyOperator

@task(task_id="inicio")
def inicio():
    print('inicio')

@task(task_id='fim', trigger_rule="all_done")
def fim():
    print('fim')

@task(task_id="task4", trigger_rule="all_done")
def task4():
    print('task4')

default_args = {'owner': 'teste','depends_on_past':False,'start_date':datetime(2024,1,1),'retries':0 }

#Para o agendamento usar o parametro schedule_interval=timedelta(minutes=60)
with DAG('dag-teste', catchup=False, default_args=default_args) as dag:
    t0 = inicio()
    t1 = BashOperator(task_id="task1", bash_command="sleep 10")
    t2 = BashOperator(task_id="task2", bash_command="sleep 10")
    t3 = BashOperator(task_id="task3", bash_command="sleep 10")
    t4 = task4()
    t5 = fim()

t0 >> [t1, t2, t3, t4] >> t5
