import sys
import string
import requests
import json

dic_openrdap = {}
dic_openrdap_ip = {}

def parse():
	r = requests.get('https://rdap.registro.br/domain/businesscorp.com.br')
	retorno_rdap = r.text
	json_rdap = json.loads(retorno_rdap)
	dic_openrdap['domain'] = json_rdap['handle']

	for name in json_rdap['nameservers']:
		dic_openrdap['nameservers'] = (name['ldhName'])

	dic_openrdap['dono'] = (json_rdap['entities'][0]['vcardArray'][1][2][3])
	#nesse caso ser acessa arrays dentro de arrays por isso vc coloca a posição do item que vc quer da array
	dic_openrdap['responsavel'] = (json_rdap['entities'][1]['vcardArray'][1][2][3]) 

	print(dic_openrdap)

def parse_tool():
	with open('/home/henrique/smart-recon/openrdap.json') as jsonfile:
		json_rdap_ip = json.load(jsonfile) #json.load é pra ler um arquivo e json.loads é só pra ler strings
		dic_openrdap_ip['blocoip'] = json_rdap_ip['handle']
		dic_openrdap_ip['startAddress'] = json_rdap_ip['startAddress']
		dic_openrdap_ip['endAddress'] = json_rdap_ip['endAddress']
		print(dic_openrdap_ip)

def main():
	parse()
	parse_tool()
	
if __name__=='__main__':
	main()
	
